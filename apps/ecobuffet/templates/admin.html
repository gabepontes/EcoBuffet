[[extend 'layout.html']]

<div id="vue-target" data-restaurant-id="[[=restaurant_id]]">
    <h1 class="title has-text-centered">Admin Page for [[=restaurant_name]]</h1>
  
  <div class="tabs is-centered is-boxed is-medium">
    <ul>
      <li :class="{ 'is-active': tab === 'add' }">
        <a @click="tab = 'add'">Add Item</a>
      </li>
      <li :class="{ 'is-active': tab === 'edit' }">
        <a @click="tab = 'edit'">Edit Item</a>
      </li>
      <li :class="{ 'is-active': tab === 'remove' }">
        <a @click="tab = 'remove'">Remove Item</a>
      </li>
    </ul>
  </div>

<!-- Add Item Form -->
<div class="box" v-if="tab === 'add'">
    <form @submit.prevent="addItem">
        <div class="field">
            <label class="label">Item name</label>
            <div class="control">
                <input class="input" type="text" v-model="newItem.name" placeholder="Item name">
            </div>
        </div>

        <div class="field">
            <label class="label">Item description</label>
            <div class="control">
                <input class="input" type="text" v-model="newItem.description" placeholder="Item description">
            </div>
        </div>

        <div class="file has-name is-fullwidth">
            <label class="file-label">
                <input class="file-input" type="file" ref="file" @change="handleFileUpload">
                <span class="file-cta">
                    <span class="file-icon">
                        <i class="fas fa-upload"></i>
                    </span>
                    <span class="file-label">Choose a file…</span>
                </span>
            </label>
        </div>
        
        <div class="field is-grouped">
            <div class="control">
                <button class="button is-link">Add</button>
            </div>
        </div>
    </form>
</div>

<!-- Edit Item Form -->
<div class="box" v-if="tab === 'edit'">
    <div class="field">
        <label class="label">Select an item to edit</label>
        <div class="control">
            <div class="select is-fullwidth">
                <select v-model="selectedItemId" @change="populateItemDetails(selectedItemId)">
                    <option v-for="item in items" :value="item.id">{{item.name}}</option>
                </select>
            </div>
        </div>
    </div>

    <div class="field">
        <label class="label">Item name</label>
        <div class="control">
            <input class="input" type="text" v-model="selectedItemName" placeholder="Item name">
        </div>
    </div>

    <div class="field">
        <label class="label">Item description</label>
        <div class="control">
            <input class="input" type="text" v-model="selectedItemDescription" placeholder="Item description">
        </div>
    </div>

    <div class="file has-name is-fullwidth">
        <label class="file-label">
            <input class="file-input" type="file" ref="editFile" @change="handleEditFileUpload">
            <span class="file-cta">
                <span class="file-icon">
                    <i class="fas fa-upload"></i>
                </span>
                <span class="file-label">Choose a file…</span>
            </label>
        </div>

    <div class="field is-grouped">
        <div class="control">
            <button class="button is-link" @click="editItem">Edit</button>
        </div>
    </div>
</div>




    <!-- Remove Item -->
    <div v-if="tab === 'remove'">
        <select v-model="selectedItemId">
        <option v-for="item in items" :value="item.id">{{item.name}}</option>
        </select>
        <button @click="removeItem">Remove</button>
    </div>


  [[block page_scripts]]
  <script>
    let getRestaurantsUrl = "[[=XML(get_restaurants_url)]]";
    let getItemsUrl = "[[=XML(get_items_url)]]";
    let addItemsUrl = "[[=XML(add_items_url)]]";
    let editItemsUrl = "[[=XML(edit_items_url)]]";
    let removeItemsUrl = "[[=XML(remove_items_url)]]";
  </script>
  <script src="js/axios.js"></script>
  <script src="js/sugar.js"></script>
  <script src="js/admin.js"></script>
  [[end]]
</div>
